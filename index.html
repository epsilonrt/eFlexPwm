<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>eFlexPwm: eFlexPwm</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">eFlexPwm
   </div>
   <div id="projectbrief">Arduino eFlexPwm library for Teensy 4.x</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">eFlexPwm </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a>Arduino eFlexPwm library for Teensy 4.x (and SparkFun MicroMod Teensy)</p>
<p><a href="https://www.nxp.com/docs/en/application-note/AN4485.pdf"><img src="https://raw.githubusercontent.com/epsilonrt/eFlexPwm/master/extras/images/eflexpwm_logo_small.png" alt="eFlexPwm Logo" align="right" valign="top" class="inline"/> </a></p>
<p><a href="https://github.com/epsilonrt/eFlexPwm/releases"><img src="https://img.shields.io/github/v/release/epsilonrt/eFlexPwm?include_prereleases" alt="GitHub release (latest by date including pre-releases)" class="inline"/></a> <a href="https://registry.platformio.org/libraries/epsilonrt/eFlexPwm"><img src="https://badges.registry.platformio.org/packages/epsilonrt/library/eFlexPwm.svg" alt="PlatformIO Registry" style="pointer-events: none;" class="inline"/></a> <a href="https://www.arduinolibraries.info/libraries/e-flex-pwm"><img src="https://www.ardu-badge.com/badge/eFlexPwm.svg" alt="Arduino Registry" style="pointer-events: none;" class="inline"/></a></p>
<p><a href="https://www.arduino.cc/"><img src="https://img.shields.io/badge/Framework-Arduino-blue" alt="Framework" class="inline"/></a> <a href="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensy40.yml"><img src="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensy40.yml/badge.svg" alt="Teensy4.0" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensy41.yml"><img src="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensy41.yml/badge.svg" alt="Teensy4.1" style="pointer-events: none;" class="inline"/></a> <a href="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensymm.yml"><img src="https://github.com/epsilonrt/eFlexPwm/actions/workflows/build_teensymm.yml/badge.svg" alt="TeensyMM" style="pointer-events: none;" class="inline"/></a></p>
<hr  />
<p>This library allows advanced use of NXP eFlexPWM timers. These timers are very powerful and can be used to manage power stages, motor controls, etc.</p>
<p>The Arduino API is easy to use, unfortunately, the analogWrite() function allows you to do very little when compared to the very advanced possibilities of the eFlexPwm timers of NXP microcontrollers such as the i.MXRT 1062 which equips the Teesny 4.x !</p>
<p>Here is an example of 6 synchronized signals with deadtime generated by the eFlexPwmSimple program:</p>
<p><img src="https://raw.githubusercontent.com/epsilonrt/eFlexPwm/master/extras/images/dslogic_example_simple.png" alt="DsLogic View" align="center" width="800" class="inline"/></p>
<p>These signals are generated with the source code below :</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;eFlexPwm.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="a00030.html">eFlex</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// My eFlexPWM submodules (Hardware &gt; PWM2: SM[0], SM[2], SM[3])</span></div>
<div class="line">SubModule Sm20 (4, 33);</div>
<div class="line">SubModule Sm22 (6, 9);</div>
<div class="line">SubModule Sm23 (36, 37);</div>
<div class="line"><span class="comment">//  Tm2 simplifies access to the functions that concern all the sub-modules</span></div>
<div class="line">Timer &amp;Tm2 = Sm20.timer();</div>
<div class="line"> </div>
<div class="line">uint8_t dutyCyclePercent = 0; <span class="comment">// the duty cycle in %</span></div>
<div class="line"><span class="keyword">const</span> uint32_t PwmFreq = 18000; <span class="comment">// FPwm 18kHz</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup() {</div>
<div class="line"> </div>
<div class="line">  Config myConfig;</div>
<div class="line">  myConfig.setReloadLogic (<a class="code" href="a00028.html#gga95ad81203168f744a37710a07e51896aa143f812e649672592ac6f2966239a80f">kPWM_ReloadPwmFullCycle</a>);</div>
<div class="line">  myConfig.setPairOperation (<a class="code" href="a00028.html#gga63a8dfd89261e7acebd33a9f12f01574a001cd311a33d4f1bf3bcfb0882ed30c2">kPWM_ComplementaryPwmA</a>);</div>
<div class="line">  myConfig.setPwmFreqHz (PwmFreq); </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize submodule</span></div>
<div class="line">  Sm20.configure (myConfig);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialize submodule 2, make it use same counter clock as submodule 0. </span></div>
<div class="line">  myConfig.setClockSource (<a class="code" href="a00028.html#ggad24dbd7a287a6152a9a3237c318be541acb3515bd116d5f3603ddedcfe12f0ec8">kPWM_Submodule0Clock</a>);</div>
<div class="line">  myConfig.setPrescale (<a class="code" href="a00028.html#gga95e14f2415bc08bc74dddd5ab3d21040af9a5a8f75935115c248270592ebc1958">kPWM_Prescale_Divide_1</a>);</div>
<div class="line">  myConfig.setInitializationControl (<a class="code" href="a00028.html#gga6e22b39950e0c29cd7aceb30bbee0080a46d08f3cb3f213bfc543a5f31140dd89">kPWM_Initialize_MasterSync</a>);</div>
<div class="line"> </div>
<div class="line">  Sm22.configure (myConfig);</div>
<div class="line">  Sm23.configure (myConfig);</div>
<div class="line">  Tm2.setupDeadtime (500); <span class="comment">// deatime 500ns</span></div>
<div class="line">  <span class="comment">// synchronize registers and start all submodules</span></div>
<div class="line">  Tm2.begin();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> loop() {</div>
<div class="line">  dutyCyclePercent += 5;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Update duty cycles for all 3 PWM signals</span></div>
<div class="line">  Sm20.updateDutyCyclePercent (dutyCyclePercent, ChanA);</div>
<div class="line">  Sm22.updateDutyCyclePercent (dutyCyclePercent &gt;&gt; 1, ChanA);</div>
<div class="line">  Sm23.updateDutyCyclePercent (dutyCyclePercent &gt;&gt; 2, ChanA);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set the load okay bit for all submodules to load registers from their buffer</span></div>
<div class="line">  Tm2.setPwmLdok();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (dutyCyclePercent &gt;= 100) {</div>
<div class="line">    </div>
<div class="line">    dutyCyclePercent = 5;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Delay at least 100 PWM periods</span></div>
<div class="line">  delayMicroseconds ( (1000000U / PwmFreq) * 100);</div>
<div class="line">}</div>
<div class="ttc" id="aa00028_html_gga63a8dfd89261e7acebd33a9f12f01574a001cd311a33d4f1bf3bcfb0882ed30c2"><div class="ttname"><a href="a00028.html#gga63a8dfd89261e7acebd33a9f12f01574a001cd311a33d4f1bf3bcfb0882ed30c2">kPWM_ComplementaryPwmA</a></div><div class="ttdeci">@ kPWM_ComplementaryPwmA</div><div class="ttdef"><b>Definition:</b> <a href="a00023_source.html#l00167">nxp-enums-struct.h:167</a></div></div>
<div class="ttc" id="aa00028_html_gga6e22b39950e0c29cd7aceb30bbee0080a46d08f3cb3f213bfc543a5f31140dd89"><div class="ttname"><a href="a00028.html#gga6e22b39950e0c29cd7aceb30bbee0080a46d08f3cb3f213bfc543a5f31140dd89">kPWM_Initialize_MasterSync</a></div><div class="ttdeci">@ kPWM_Initialize_MasterSync</div><div class="ttdef"><b>Definition:</b> <a href="a00023_source.html#l00102">nxp-enums-struct.h:102</a></div></div>
<div class="ttc" id="aa00028_html_gga95ad81203168f744a37710a07e51896aa143f812e649672592ac6f2966239a80f"><div class="ttname"><a href="a00028.html#gga95ad81203168f744a37710a07e51896aa143f812e649672592ac6f2966239a80f">kPWM_ReloadPwmFullCycle</a></div><div class="ttdeci">@ kPWM_ReloadPwmFullCycle</div><div class="ttdef"><b>Definition:</b> <a href="a00023_source.html#l00175">nxp-enums-struct.h:175</a></div></div>
<div class="ttc" id="aa00028_html_gga95e14f2415bc08bc74dddd5ab3d21040af9a5a8f75935115c248270592ebc1958"><div class="ttname"><a href="a00028.html#gga95e14f2415bc08bc74dddd5ab3d21040af9a5a8f75935115c248270592ebc1958">kPWM_Prescale_Divide_1</a></div><div class="ttdeci">@ kPWM_Prescale_Divide_1</div><div class="ttdef"><b>Definition:</b> <a href="a00023_source.html#l00066">nxp-enums-struct.h:66</a></div></div>
<div class="ttc" id="aa00028_html_ggad24dbd7a287a6152a9a3237c318be541acb3515bd116d5f3603ddedcfe12f0ec8"><div class="ttname"><a href="a00028.html#ggad24dbd7a287a6152a9a3237c318be541acb3515bd116d5f3603ddedcfe12f0ec8">kPWM_Submodule0Clock</a></div><div class="ttdeci">@ kPWM_Submodule0Clock</div><div class="ttdef"><b>Definition:</b> <a href="a00023_source.html#l00062">nxp-enums-struct.h:61</a></div></div>
<div class="ttc" id="aa00030_html"><div class="ttname"><a href="a00030.html">eFlex</a></div><div class="ttdoc">Library namespace.</div><div class="ttdef"><b>Definition:</b> <a href="a00011_source.html#l00011">eFlexPwmConfig.h:11</a></div></div>
</div><!-- fragment --><p>But this is only a small example of the possibilities offered by the eFlexPwm timers which are also designed to generate SPWM signals (Sine Pulse Width Modulation) :</p>
<p><img src="https://raw.githubusercontent.com/epsilonrt/eFlexPwm/master/extras/images/rigol_single_phase_inverter_100hz.png" alt="Rigol View" align="center" width="800" class="inline"/></p>
<p>This library is based on the code of the FSL_PWM driver from the NXP SDK, it is published under the BSD 3-Clause License. <b>It is still in beta version.</b></p>
<p><b>Teesny eFlexPWM pins</b></p>
<p>The table below will allow you to identify the pins of the Teensy to use, by clicking on it, you can the Libre Office version of this table :</p>
<p><a href="https://github.com/epsilonrt/eFlexPwm/raw/master/extras/doc/TeensyPwmPins.ods"><img src="https://raw.githubusercontent.com/epsilonrt/eFlexPwm/master/extras/images/teensy-eflexpwm-pin.png" alt="Teesny eFlexPWM pins" align="center" width="800" class="inline"/> </a> </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Apr 10 2023 13:23:44 for eFlexPwm by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
